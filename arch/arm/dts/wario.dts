/*
 * Copyright (C) 2013 Freescale Semiconductor, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

/dts-v1/;

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include "imx6sl.dtsi"

/ {
	model = "Amazon Wario";
	compatible = "amazon,wario", "fsl,imx6sl";

	aliases {
        mmc1 = &usdhc2;
		usbotg0 = &usbotg1;
	};

	memory {
		reg = <0x80000000 0x40000000>;
	};

	regulators {
		compatible = "simple-bus";
		#address-cells = <1>;
		#size-cells = <0>;

		reg_sd2_vmmc: sd2_vmmc { //TODO This is probably in the max77696
			compatible = "regulator-fixed";
			regulator-name = "eMMC-VCCQ";
			regulator-min-microvolt = <1800000>;
			regulator-max-microvolt = <1800000>;
			regulator-boot-on;
		};
	};

	backlight {
		compatible = "pwm-backlight";
		pwms = <&bl_pwm 0 3921569>;
		brightness-levels = <0 4 8 16 32 64 128 255>;
		default-brightness-level = <6>;
	};
};

&iomuxc {
	pinctrl-names = "default";

	wario {
		pinctrl_uart1: uart1grp {
			fsl,pins = <
				MX6SL_PAD_UART1_RXD__UART1_RX_DATA	0x1b0b1
				MX6SL_PAD_UART1_TXD__UART1_TX_DATA	0x1b0b1
			>;
		};

		pinctrl_usdhc2: usdhc2grp {
			fsl,pins = <
				/*
				LVE_ENABLED,HYS_ENABLED,PUS_22KOHM_PU,PUE_PULL,
				PKE_ENABLED,ODE_DISABLED,SPD_100MHZ,DSE_40OHM,SRE_FAST
				*/
				MX6SL_PAD_SD2_CLK__SD2_CLK			0x41F071
				MX6SL_PAD_SD2_CMD__SD2_CMD			0x41F071
				MX6SL_PAD_SD2_DAT0__SD2_DATA0		0x41F071
				MX6SL_PAD_SD2_DAT1__SD2_DATA1		0x41F071
				MX6SL_PAD_SD2_DAT2__SD2_DATA2		0x41F071
				MX6SL_PAD_SD2_DAT3__SD2_DATA3		0x41F071
				MX6SL_PAD_SD2_DAT4__SD2_DATA4		0x41F071
				MX6SL_PAD_SD2_DAT5__SD2_DATA5		0x41F071
				MX6SL_PAD_SD2_DAT6__SD2_DATA6		0x41F071
				MX6SL_PAD_SD2_DAT7__SD2_DATA7		0x41F071
				/*
				LVE_ENABLED,HYS_ENABLED,PUS_100KOHM_PU,PUE_PULL,
				PKE_ENABLED,ODE_DISABLED,SPD_100MHZ,DSE_40OHM,SRE_FAST
				*/
				MX6SL_PAD_SD2_RST__SD2_RESET		0x413071
			>;
		};

		pinctrl_usdhc3: usdhc3grp {
			fsl,pins = <
				/*
				LVE_ENABLED,HYS_ENABLED,PUS_22KOHM_PU,PUE_PULL,
				PKE_ENABLED,ODE_DISABLED,SPD_100MHZ,DSE_40OHM,SRE_FAST
				*/
				MX6SL_PAD_SD3_CLK__SD3_CLK			0x41F071
				MX6SL_PAD_SD3_CMD__SD3_CMD			0x41F071
				MX6SL_PAD_SD3_DAT0__SD3_DATA0		0x41F071
				MX6SL_PAD_SD3_DAT1__SD3_DATA1		0x41F071
				MX6SL_PAD_SD3_DAT2__SD3_DATA2		0x41F071
				MX6SL_PAD_SD3_DAT3__SD3_DATA3		0x41F071

				/*
				WIFI_PWD
				LVE_ENABLED, HYS_ENABLED, PUS_100KOHM_PU, PUE_PULL, 
				PKE_ENABLED, ODE_DISABLED, SPD_100MHZ, DSE_40OHM, SRE_SLOW
				*/
				MX6SL_PAD_KEY_ROW2__GPIO3_IO29		0x41B0B0

				/*
				Unknown function
				LVE_ENABLED, HYS_ENABLED, PUS_100KOHM_PD, PUE_KEEP, 
				PKE_ENABLED, ODE_DISABLED, SPD_100MHZ, DSE_40OHM, SRE_SLOW
				*/
				MX6SL_PAD_LCD_VSYNC__GPIO2_IO18		0x4110B0
			>;
		};
		
		pinctrl_i2c1: i2c1grp {
			fsl,pins = <
				MX6SL_PAD_I2C1_SCL__I2C1_SCL	0x4001b8b1
				MX6SL_PAD_I2C1_SDA__I2C1_SDA	0x4001b8b1
			>;
		};
	};
};

&uart1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_uart1>;
	status = "okay";
};

&usdhc2 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc2>;
	bus-width = <8>;
	vqmmc-supply = <&reg_sd2_vmmc>;
	non-removable;
	status = "okay";
};

&usdhc3 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_usdhc3>;
	bus-width = <4>;
	vqmmc-supply = <&reg_sd2_vmmc>;
	non-removable;
	status = "okay";
};

&usbotg1 {
	pinctrl-names = "default";
	disable-over-current;
	dr_mode = "peripheral";
	status = "okay";
};

&i2c1 {
	clock-frequency = <100000>;
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_i2c1>;
	status = "okay";

	pmic0: pmic0@3c {
		compatible = "maxim,max77696";
		//interrupt-parent = <&gpx3>;
		//interrupts = <7 0>;
		reg = <0x3c 0 0>;
		#clock-cells = <1>;

		pwm {
			bl_pwm: BLPWM {
				#pwm-cells = <2>;
				status = "okay";
			};
		};

		voltage-regulators {
			ldo1_reg: LDO1 {
				regulator-name = "VDD_ZFORCE2";
				regulator-min-microvolt = <3000000>;
				regulator-max-microvolt = <3300000>;
			};

			ldo2_reg: LDO2 {
				regulator-name = "VDD_USBPHY";
				regulator-min-microvolt = <3000000>;
				regulator-max-microvolt = <3000000>;
			};

			//TODO: LDO3 Unknown

			//LDO4-5 Disabled - input grounded

			ldo6_reg: LDO6 {
				regulator-name = "VDD_SNVS";
				regulator-min-microvolt = <1600000>;
				regulator-max-microvolt = <1600000>;
			};

			ldo7_reg: LDO7 {
				regulator-name = "VDD_KEEPER";
				regulator-min-microvolt = <3200000>;
				regulator-max-microvolt = <3200000>;
			};

			//LDO8-9 Disabled - input grounded

			ldo10_reg: LDO10 {
				regulator-name = "VBUS";
				regulator-min-microvolt = <5000000>;
				regulator-max-microvolt = <5000000>;
			};

			sd1_reg: SD1 {
				regulator-name = "VDD_CORE";
				regulator-min-microvolt = <1250000>;
				regulator-max-microvolt = <1250000>;
			};

			sd2_reg: SD2 {
				regulator-name = "VDD_SOC";
				regulator-min-microvolt = <1200000>;
				regulator-max-microvolt = <1200000>;
			};

			sd3_reg: SD3 {
				regulator-name = "V_SD3";
				regulator-min-microvolt = <1300000>;
				regulator-max-microvolt = <1300000>;
			};

			sd4_reg: SD4 {
				regulator-name = "V_SD4";
				regulator-min-microvolt = <1200000>;
				regulator-max-microvolt = <1200000>;
			};

			sd5_reg: SD5 {
				regulator-name = "V_SD5";
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <1800000>;
			};

			sd6_reg: SD6 {
				regulator-name = "V_SD6";
				regulator-min-microvolt = <3100000>;
				regulator-max-microvolt = <3250000>;
			};
		};
	};
};